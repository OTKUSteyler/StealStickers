(function(p,c,k,i){"use strict";const{Platform:h}=k.ReactNative;let s=null;function w(){if(s)return s;try{s=c.findByProps("downloadFile",!1)||c.findByProps("saveFile",!1)||c.findByProps("downloadAsset",!1)}catch(n){console.warn("[StealStickers] Could not find file manager module:",n)}return s}function m(n){if(!n)return null;if(n.stickers&&Array.isArray(n.stickers)&&n.stickers.length>0){const r=n.stickers[0];return{id:r.id,name:r.name||"sticker",url:S(r),format:r.format_type||1}}return n.id&&n.format_type?{id:n.id,name:n.name||"sticker",url:S(n),format:n.format_type||1}:null}function S(n){const r=n.format_type===3?"json":"png";return`https://cdn.discordapp.com/stickers/${n.id}.${r}`}function g(n){switch(n){case 1:return"png";case 2:return"apng";case 3:return"json";default:return"png"}}async function A(n){try{const r=w(),o=g(n.format),u=`${n.name.replace(/[^a-zA-Z0-9]/g,"_")}_${n.id}.${o}`;if(r?.downloadFile){await r.downloadFile(n.url,u),i.showToast(`Downloaded ${n.name}! \u{1F4E5}`);return}if(r?.saveFile){await r.saveFile(n.url,u),i.showToast(`Saved ${n.name}! \u{1F4E5}`);return}if(h.OS==="android"||h.OS==="ios"){const{Linking:l}=k.ReactNative;await l.openURL(n.url),i.showToast("Opened sticker URL in browser \u{1F310}")}else i.showToast("Download not supported on this platform \u274C")}catch(r){console.error("[StealStickers] Download failed:",r),i.showToast(`Failed to download sticker: ${r.message}`)}}function y(n){return{key:"stealSticker",label:"\u{1F4E5} Download Sticker",onPress:function(){A(n)}}}let t=null;function b(){const n=typeof window<"u"?window.bunny:null,{patcher:r}=n||{};if(!r||typeof r.after!="function"){console.error("[StealStickers] Patcher not available!");return}try{const o=c.findByProps("markAsUnread","suppressEmbeds",!1);if(!o){console.warn("[StealStickers] Could not find message actions module");return}const u=["getActions","buildActions","default"];let l=null;for(const a of u)if(typeof o[a]=="function"){l=a;break}if(!l){console.error("[StealStickers] No patchable function found. Available keys:",Object.keys(o));return}t=r.after(l,o,function(a,e){const v=a[0]&&a[0].message||a[0]||null,f=m(v);if(!f)return e;if(Array.isArray(e))return e.push(y(f)),e;if(e&&e.props){if(Array.isArray(e.props.options))return e.props.options.push(y(f)),e;if(Array.isArray(e.props.children)){for(const d of e.props.children)if(d&&d.props&&Array.isArray(d.props.options))return d.props.options.push(y(f)),e}}return e}),console.log("[StealStickers] Patch applied")}catch(o){console.error("[StealStickers] Failed to apply patch:",o)}}var F={onLoad:function(){try{b(),console.log("[StealStickers] Enabled \u{1F4E5}")}catch(n){if(console.error("[StealStickers] Failed to enable:",n),typeof t=="function"){try{t()}catch{}t=null}}},onUnload:function(){const n=t;if(t=null,s=null,typeof n=="function")try{n()}catch(r){console.error("[StealStickers] Error during unpatch:",r)}console.log("[StealStickers] Disabled")}};return p.default=F,Object.defineProperty(p,"__esModule",{value:!0}),p})({},vendetta.metro,vendetta.metro.common,vendetta.ui.toasts);
